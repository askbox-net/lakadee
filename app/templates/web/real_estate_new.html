{% extends 'layouts/master.html' %}
{% block title %}Product{% endblock %}
{% block body %}
<h1>Real State</h1>
<form action="{{ url_for('real_estate_add') }}" method="post">
	<div class="sell-upload-figure">
		<div>
			<ul class="preview">
			</ul>
		</div>

		<div>
			<input id="sell-upload-drop-file" name="upload_image" type="file"> <!-- style="display: none;" -->
			<pre class="visible-pc">ドラッグアンドドロップまたはクリックしてファイルをアップロード123</pre>
			<i class="icon-camera"></i>

		</div>
	</div>
	
	{{ generate_fields(form) }}
	<input type="submit" class="btn btn-success" value="Add">
</form>

<script>
$(function(){
	var no = 0;
  //画像ファイルプレビュー表示のイベント追加 fileを選択時に発火するイベントを登録
  $('#sell-upload-drop-file').change(function(e) {
    var file = e.target.files[0],
        reader = new FileReader(),
        $preview = $(".preview");

    // 画像ファイル以外の場合は何もしない
    if(file.type.indexOf("image") < 0){
      alert("画像ファイルを指定してください。");
      return false;
    }

    // ファイル読み込みが完了した際のイベント登録
    reader.onload = (function(file) {
      return function(e) {
        //既存のプレビューを削除
        //$preview.empty();
        // .prevewの領域の中にロードした画像を表示するimageタグを追加
	      no++;
	      $preview.append(`<li><img id="img_${ no }"></li>`);
        //$preview.append($('<img>').attr({
		$(`#img_${ no }`).attr({
                  src: e.target.result,
                  width: "150px",
                  class: "img_preview",
                  title: file.name
              });
      };
    })(file);

    reader.readAsDataURL(file);
  });
});

</script>
{% endblock %}

